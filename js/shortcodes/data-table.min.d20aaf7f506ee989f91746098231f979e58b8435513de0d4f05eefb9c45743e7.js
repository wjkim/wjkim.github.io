function downloadCSV(e){const t=e.dataset.filename;if(!t)return;const n=document.querySelector(`.data-table[data-filename="${t}"]`);if(!n)return;function s(e){const t=[],n=e.querySelectorAll("thead th"),s=e.querySelectorAll("tbody tr"),o=Array.from(n).map(e=>e.getAttribute("title")||e.textContent.trim());return t.push(o),s.forEach(e=>{const n=e.querySelectorAll("td"),s=Array.from(n).map(e=>e.getAttribute("title")||e.textContent.trim());t.push(s)}),t}function o(e,t){const n=e.includes(",");if(t!==","&&n){const t=e.replace(/"/g,'""');return`"${t}"`}if(n||e.includes('"')||e.includes(`
`)){const t=e.replace(/"/g,'""');return`"${t}"`}return e}function i(e,t){const n=new Blob(["ï»¿"+e],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(n,t);else{const e=document.createElement("a"),s=URL.createObjectURL(n);e.href=s,e.download=t,e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(s)}}const a=e.dataset.delimiter,r=s(n),c=r.map(e=>e.map(e=>o(e,a)).join(",")).join(`
`);i(c,t)}window.addEventListener("load",function(){const e=document.getElementById("content-wrap");if(!e)return;const t=e.offsetWidth;document.querySelectorAll(".sc-data-table").forEach(e=>{const n=e.querySelector("thead").offsetWidth;if(n>t){const t=e.querySelector(".data-table-caption");e.insertBefore(t,e.firstChild),e.classList.add("overflow")}})})